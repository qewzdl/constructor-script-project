{{ define "components/document-head" }}
    {{- $ctx := .Context -}}
    {{- $lang := or .Lang (or $ctx.Language "en") -}}
    {{- $site := $ctx.Site -}}
    {{- $defaultLang := or ($site.DefaultLanguage) $lang -}}
    {{- $supportedLangs := $site.SupportedLanguages -}}
    <head>
        <!-- Define character encoding and responsive viewport -->
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Content-Language" content="{{ $lang }}" />

        <!-- Dynamic page title -->
        <title>{{ $ctx.Title }}</title>

        <!-- Unique SEO description (displayed in search results) -->
        {{ if $ctx.Description }}
        <meta name="description" content="{{ $ctx.Description }}" />
        {{ end }} {{ if $ctx.Keywords }}
        <meta name="keywords" content="{{ $ctx.Keywords }}" />
        {{ end }} {{ if $ctx.Canonical }}
        <link rel="canonical" href="{{ $ctx.Canonical }}" />
        {{ end }}

        <!-- Website author -->
        <meta name="author" content="{{ $site.Name }}" />

        <!-- Control search engine indexing -->
        {{ if $ctx.NoIndex }}
        <meta name="robots" content="noindex, nofollow" />
        {{ else }}
        <meta name="robots" content="index, follow" />
        {{ end }}

        <script>
            (function () {
                const storageKey = "theme";
                const root = document.documentElement;

                try {
                    const storedTheme = localStorage.getItem(storageKey);
                    if (storedTheme === "light" || storedTheme === "dark") {
                        root.setAttribute("data-theme", storedTheme);
                        return;
                    }
                } catch (error) {}

                const prefersDark =
                    window.matchMedia &&
                    window.matchMedia("(prefers-color-scheme: dark)").matches;

                if (prefersDark) {
                    root.setAttribute("data-theme", "dark");
                }
            })();
        </script>

        <!-- Core CSS stylesheets -->
        <link rel="stylesheet" href="{{ asset "/static/css/core/root.css" }}" />
        <link rel="stylesheet" href="{{ asset "/static/css/core/layout.css" }}" />
        <link rel="stylesheet" href="{{ asset "/static/css/core/base.css" }}" />
        <link rel="stylesheet" href="{{ asset "/static/css/elements/index.css" }}" />
        <link rel="stylesheet" href="{{ asset "/static/css/sections/index.css" }}" />

        {{ if $ctx.Styles }} {{ range $ctx.Styles }}
        <link rel="stylesheet" href="{{ asset . }}" />
        {{ end }} {{ end }}

        <!-- Favicon for browser tab -->
        {{ if $site.FaviconType }}
        <link
            rel="icon"
            href="{{ $site.Favicon }}"
            type="{{ $site.FaviconType }}"
        />
        {{ else }}
        <link rel="icon" href="{{ $site.Favicon }}" />
        {{ end }}

        <!-- Font performance hints -->
        {{ range $site.FontPreconnects }}
        <link rel="preconnect" href="{{ . }}" crossorigin />
        {{ end }}

        <!-- External font includes -->
        {{ range $site.Fonts }}
        {{ if .Snippet }}{{ safe .Snippet }}{{ end }}
        {{ end }}

        {{ $ads := $ctx.Advertising }}
        {{ if and $ads ( $ads.Enabled ) }}
        {{ range $ads.HeadSnippets }}
        {{ . }}
        {{ end }}
        {{ end }}

        <!-- Open Graph and Twitter Card metadata for social media sharing -->
        <meta property="og:site_name" content="{{ $site.Name }}" />
        {{ if $defaultLang }}
        <meta property="og:locale" content="{{ $defaultLang }}" />
        {{ end }}
        {{ if $ctx.Title }}
        <meta property="og:title" content="{{ $ctx.Title }}" />
        {{ end }} {{ if $ctx.Description }}
        <meta property="og:description" content="{{ $ctx.Description }}" />
        {{ end }} {{ if $ctx.OGType }}
        <meta property="og:type" content="{{ $ctx.OGType }}" />
        {{ end }} {{ if $ctx.OGURL }}
        <meta property="og:url" content="{{ $ctx.OGURL }}" />
        {{ end }} {{ if $ctx.OGImage }}
        <meta property="og:image" content="{{ $ctx.OGImage }}" />
        {{ if $ctx.OGImageAlt }}
        <meta property="og:image:alt" content="{{ $ctx.OGImageAlt }}" />
        {{ end }} {{ end }} {{ if $ctx.TwitterCard }}
        <meta name="twitter:card" content="{{ $ctx.TwitterCard }}" />
        {{ end }} {{ if $ctx.TwitterTitle }}
        <meta name="twitter:title" content="{{ $ctx.TwitterTitle }}" />
        {{ end }} {{ if $ctx.TwitterDescription }}
        <meta name="twitter:description" content="{{ $ctx.TwitterDescription }}" />
        {{ end }} {{ if $ctx.TwitterImage }}
        <meta name="twitter:image" content="{{ $ctx.TwitterImage }}" />
        {{ if $ctx.TwitterImageAlt }}
        <meta name="twitter:image:alt" content="{{ $ctx.TwitterImageAlt }}" />
        {{ end }} {{ end }} {{ if $ctx.Canonical }}
        <meta name="twitter:url" content="{{ $ctx.Canonical }}" />
        {{ end }}
        {{ if and $ctx.Canonical (gt (len $supportedLangs) 1) }}
        {{ range $index, $code := $supportedLangs }}
        {{ if ne $code (index $supportedLangs 0) }}
        <link rel="alternate" hreflang="{{ $code }}" href="{{ $ctx.Canonical }}" />
        {{ end }}
        {{ end }}
        {{ end }}

        <!-- Structured data (Organization) for rich results in search engines -->
        <script type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": "Organization",
                "name": "{{ $site.Name }}",
                "logo": "{{ $site.Logo }}",
                "url": "{{ $site.URL }}"
            }
        </script>
        {{ if $ctx.StructuredData }}
        <script type="application/ld+json">
            {{ $ctx.StructuredData }}
        </script>
        {{ end }}
    </head>
{{ end }}
